syntax = "proto3";
option go_package = "pkg/packets";

message Packet{
  oneof msg{
    InputPacket input = 2;
    PositionSyncMessage position_sync = 3;
    PlayerSyncMessage player_sync = 4;
    HealthSyncMessage health_sync = 5;
    AttackSyncMessage attack_sync = 6;
    ManaSyncMessage mana_sync = 7;
    AttackSpeedSyncMessage attack_speed_sync = 8;
    SyncSkillMessage sync_skill = 9;
    ObjectsDestroyedSyncMessage objects_destroyed_sync = 10;
    StateSyncMessage state_sync = 11;
    SkillAttributeMessage skill_attribute_sync = 12;
    SpeedSyncMessage speed_sync = 13;
    CreatePlayerMessage create_player = 14;
    ObjectSyncMessage object_sync = 15;
  }
}

message InputPacket{
  oneof input{
    MoveMessage move = 1;
    AttackMessage player_attack = 2;
    ExecuteSkillMessage execute_skill = 3;
    CreateTestPlayerMessage create_test_player = 4;
  }
}

message MoveMessage{
  float x = 1;
  float y = 2;
}

message AttackMessage{
  uint64 uid = 1;
}

message PlayerSyncMessage{
  uint64 uid = 1;
  uint32 hero_id = 2;
  bool self = 3;
}

message PositionSyncMessage{
  uint64 id = 1;
  float pos_x = 2;
  float pos_y = 3;
}

message HealthSyncMessage{
  uint64 uid = 1;
  int32 health = 2;
  int32 max_health = 3;
}

message AttackSyncMessage{
  uint64 from = 1;
  uint64 to = 2;
}

message ManaSyncMessage{
  uint64 uid = 1;
  int32 mana = 2;
  int32 max_mana = 3;
}

message AttackSpeedSyncMessage{
  uint64 uid = 1;
  float speed = 2;
}

message SpeedSyncMessage{
  uint64 id = 1;
  float speed = 2;
}

message ExecuteSkillMessage{
  float rotate = 1;
  float pos_x = 2;
  float pos_y = 3;
}

// 同步技能信息，当释放技能时更新
message SyncSkillMessage{
  uint64 uid = 1; // 技能的来源
  int32 pos = 2;
  float left_time = 3; // 技能剩余的时间
  float angle = 4; // 技能的朝向
}

message SkillAttributeMessage{
  uint64 uid = 1;
  int64 strength = 2;
  int64 scale = 3;
  int64 efficiency = 4;
}

message ObjectsDestroyedSyncMessage{
  uint64 id = 1;
  bool is_player = 2;
}

message StateSyncMessage{
  uint64 id = 1;
  uint32 state = 2; // 0：静止，1：移动，2：攻击，3：释放技能
}

message ObjectSyncMessage{
  uint32 type_id = 1;
  uint64 id = 2;
  float x = 3;
  float y = 4;
  float scale = 5;
  float angle = 6;
}

message CreatePlayerMessage{
  uint32 hero_id = 1;
}

message CreateTestPlayerMessage{
  float x = 1;
  float y = 2;
}